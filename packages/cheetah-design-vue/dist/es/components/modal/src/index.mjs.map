{"version":3,"file":"index.mjs","sources":["../../../../../src/components/modal/src/index.tsx"],"sourcesContent":["import { type ExtractPropTypes, type PropType, Teleport, Transition, computed, defineComponent } from 'vue'\nimport { type ToggleHandler, useDraggable, useModal } from '../../../composables'\nimport { animation } from '../../../utils'\nimport Button from '../../button/src/index.vue'\n\nexport interface ModalInstance extends ToggleHandler, HTMLElement {}\nexport type ModalProps = ExtractPropTypes<typeof modalProps>\ntype ShakeOffProp = 'x-button' | 'confirm-button' | 'cancel-button' | 'mask' | 'header' | 'footer'\n\nconst modalProps = {\n  title: String,\n  cancelButtonText: String,\n  confirmButtonText: String,\n  draggable: Boolean,\n  shakeOff: {\n    type: Array as PropType<ShakeOffProp[]>,\n    default: () => [],\n  },\n}\n\nexport default defineComponent({\n  name: 'Modal',\n  props: modalProps,\n  emits: [\n    'open',\n    'close',\n    'cancel',\n    'confirm',\n  ],\n  setup(props, { slots, emit }) {\n    const { modal } = useModal(emit)\n\n    useDraggable(modal, {\n      translateX: computed(\n        () => modal.state.value\n          ? modal.value!.clientWidth / 2\n          : 0,\n      ),\n    })\n    const isShake = (prop: ShakeOffProp) => props.shakeOff.includes(prop)\n\n    const onCancel = () => modal.close() && emit('cancel')\n\n    const onConfirm = () => emit('confirm')\n\n    const onClose = () => modal.close()\n\n    const renderHeader = () => {\n      if (!isShake('header') && props.title) {\n        return (\n          <header>\n            <h3>{ props.title }</h3>\n          </header>\n        )\n      }\n    }\n\n    const renderFooter = () => {\n      if (isShake('footer'))\n        return\n\n      const renderButtons = []\n      if (!isShake('cancel-button') && props.cancelButtonText) {\n        renderButtons.push(\n          <Button\n            mode=\"outline\"\n            onClick={onCancel}\n          >\n            {props.cancelButtonText}\n          </Button>,\n        )\n      }\n      if (!isShake('confirm-button') && props.confirmButtonText) {\n        renderButtons.push(\n          <Button\n            mode=\"solid\"\n            onClick={onConfirm}\n          >\n            {props.confirmButtonText}\n          </Button>,\n        )\n      }\n\n      return (\n        <footer>\n          <div class=\"ch-modal-button\">\n            {renderButtons}\n          </div>\n        </footer>\n      )\n    }\n\n    const renderModal = () => {\n      const renderMask = () => {\n        if (!isShake('mask'))\n          return <div class={'ch-mask'} />\n      }\n\n      const renderXButton = () => {\n        if (!isShake('x-button')) {\n          return (\n            <Button\n              class='ch-modal-x'\n              mode='link'\n              state='info'\n              icon-left='x-lg'\n              onClick={onClose}\n            />\n          )\n        }\n      }\n\n      return (\n        <>\n          {renderMask()}\n          <div\n            ref={modal}\n            class=\"ch-modal\"\n            draggable={props.draggable}\n          >\n            {renderXButton()}\n            {renderHeader()}\n            <section>\n              {slots.default?.()}\n            </section>\n            {renderFooter()}\n          </div>\n        </>\n      )\n    }\n    const renderHeadless = () => (\n      <div ref={modal}>\n        {slots.headless?.()}\n      </div>\n    )\n\n    return () => (\n      <Teleport to={'body'}>\n        <Transition\n          enter-active-class={animation('fadeIn')}\n          leave-active-class={animation('fadeOut')}\n          appear\n        >\n          <div class='ch-modal-container' v-show={modal.state.value}>\n            {slots.headless ? renderHeadless() : renderModal()}\n          </div>\n        </Transition>\n      </Teleport>\n    )\n  },\n})\n"],"names":["_createVNode","Button","_Fragment","_withDirectives","_vShow"],"mappings":"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"}